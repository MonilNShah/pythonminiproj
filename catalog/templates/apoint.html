{% include "main_base.html" %}

{% block content %}


    <!-- <form method="POST" > -->
       <!-- {% csrf_token %} -->
     <!-- {{apoint.as_p}}    -->

  <!-- </form> -->
  <form class="login100-form validate-form" name="Appoint_form"  id="Appoint_form" method="post" data-slots-url="{% url 'ajax_load_slots' %}"  data-date-url="{% url 'ajax_load_finalslots' %}" novalidate>
           {% csrf_token %}
           {{ apoint.non_field_errors }}
          <span class="login100-form-title p-b-26">
              Take Appointment
          </span>
          <span class="login100-form-title p-b-48">
              <i class="zmdi zmdi-font"></i>
          </span>


          <div class="wrap-input100" >
              <input  class="input100" type="date" id="id_date" name="date" for="{{ apoint.date.id_for_label }}">
              <span class="focus-input100" data-placeholder="Username"></span> 
          </div>
          {{ apoint.date.errors }} 

          <div class="dropdown" >
            <select class="dropdown-content" type="dropdown" id="id_doctor_name" name="doctor_name" for="{{ apoint.doctor_name.id_for_label }}">
                 <span class="focus-input100" data-placeholder="Username"></span>
                 <option value=" ">------</option>
                    {%for doc in doctors%}
                        <option value="{{doc}}">{{doc}}</option>
                      {%endfor%} 
            </select>
          {{ apoint.doctor_name.errors }}

          <div class="dropdown" >
               <select  class="dropdown-content" type="dropdown" id="id_slot" name="slot" for="{{ apoint.slot.id_for_label }}">
                    <span class="focus-input100" data-placeholder="Username"></span> 
                    <option value=" ">------</option>
                    {%for slot_time in slots_time %}
                          <option value="{{slot_time}}">{{slot_time}}</option>
                    {%endfor%} 
                 </select>
          {{ apoint.slot.errors }}

          <div class="container-login100-form-btn">
            <div class="wrap-login100-form-btn">
              <div class="login100-form-bgbtn"></div>
              <button class="login100-form-btn" type="submit">
                Take Appointment
              </button>
            </div>
          </div>

  </form>

  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script>
    $("#id_doctor_name").change(function () {
      var url = $("#Appoint_form").attr("data-slots-url");  // get the url of the `load_cities` view
      var doctor_name = $(this).val();  // get the selected country ID from the HTML input
      var date=$("#id_date").val();
      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
        data: {
          'doctor_name': doctor_name ,'date':date     // add the country id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_cities` view function
          $("#id_slot").html(data);  // replace the contents of the city input with the data that came from the server
        }
      });

    });

    $("#id_date").change(function () {
      var url = $("#Appoint_form").attr("data-date-url");  // get the url of the `load_cities` view
      var  date= $(this).val();  // get the selected country ID from the HTML input
      var doctor_name=$("#id_doctor_name").val();
      $.ajax({                       // initialize an AJAX request
        url: url,                    // set the url of the request (= localhost:8000/hr/ajax/load-cities/)
        data: {
          'doctor_name': doctor_name ,'date':date     // add the country id to the GET parameters
        },
        success: function (data) {   // `data` is the return of the `load_cities` view function
          $("#id_slot").html(data);  // replace the contents of the city input with the data that came from the server
        }
      });

    });


  </script>

{% endblock %}